<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>操作系统 on Svtter's Blog</title><link>https://svtter.cn/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/</link><description>Recent content in 操作系统 on Svtter's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Sat, 08 Nov 2014 01:00:00 +0800</lastBuildDate><atom:link href="https://svtter.cn/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/index.xml" rel="self" type="application/rss+xml"/><item><title>自己动手写操作系统阅读笔记（一）</title><link>https://svtter.cn/p/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E5%86%99%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0%E4%B8%80/</link><pubDate>Sat, 08 Nov 2014 01:00:00 +0800</pubDate><guid>https://svtter.cn/p/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E5%86%99%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0%E4%B8%80/</guid><description>&lt;p&gt;本来今天想要学习一下操作系统的相关内容，奈何书都没带，猛然想起自己还有一个自己动手写操作系统的梦想，于是拿出这本书重新研究以下。&lt;/p&gt;
&lt;p&gt;对于第一章节的写一个简单的boot写出来以后也是着实兴奋一把，不过也是要记下相关的信息。&lt;/p&gt;
&lt;h2 id="安装nasm"&gt;安装NASM
&lt;/h2&gt;&lt;p&gt;首先我的操作系统是Ubuntu&lt;/p&gt;
&lt;p&gt;使用&lt;code&gt;sudo aptitude install nasm&lt;/code&gt;来安装nasm&lt;/p&gt;
&lt;h2 id="然后就是简单的asm代码"&gt;然后就是简单的asm代码
&lt;/h2&gt;&lt;div class="codehilite"&gt;
&lt;pre&gt;&lt;span&gt;&lt;/span&gt; &lt;span class="nf"&gt;org&lt;/span&gt; &lt;span class="mi"&gt;07&lt;/span&gt;&lt;span class="no"&gt;c00h&lt;/span&gt; &lt;span class="c"&gt;;汇编程序加载到7c00处&lt;/span&gt;
&lt;span class="no"&gt;mov&lt;/span&gt; &lt;span class="no"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="no"&gt;cs&lt;/span&gt; &lt;span class="c"&gt;;cs 无法直接加载到ds，通过ax(x86基础)&lt;/span&gt;
&lt;span class="no"&gt;mov&lt;/span&gt; &lt;span class="no"&gt;ds&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="no"&gt;ax&lt;/span&gt;
&lt;span class="nf"&gt;mov&lt;/span&gt; &lt;span class="no"&gt;es&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="no"&gt;ax&lt;/span&gt;
&lt;span class="nf"&gt;call&lt;/span&gt; &lt;span class="no"&gt;DispStr&lt;/span&gt; &lt;span class="c"&gt;;调用显示字符串例程&lt;/span&gt;
&lt;span class="no"&gt;jmp&lt;/span&gt; &lt;span class="no"&gt;$&lt;/span&gt; &lt;span class="c"&gt;;无限循环&lt;/span&gt;
&lt;span class="no"&gt;DispStr&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="nf"&gt;mov&lt;/span&gt; &lt;span class="no"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="no"&gt;BootMessage&lt;/span&gt;
&lt;span class="no"&gt;mov&lt;/span&gt; &lt;span class="no"&gt;bp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="no"&gt;ax&lt;/span&gt;
&lt;span class="nf"&gt;mov&lt;/span&gt; &lt;span class="no"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;
&lt;span class="nf"&gt;mov&lt;/span&gt; &lt;span class="no"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;01301&lt;/span&gt;&lt;span class="no"&gt;h&lt;/span&gt;
&lt;span class="nf"&gt;mov&lt;/span&gt; &lt;span class="no"&gt;bx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;000&lt;/span&gt;&lt;span class="no"&gt;ch&lt;/span&gt;
&lt;span class="nf"&gt;mov&lt;/span&gt; &lt;span class="no"&gt;dl&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;&lt;/span&gt;
&lt;span class="nf"&gt;int&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="no"&gt;h&lt;/span&gt;
&lt;span class="nf"&gt;ret&lt;/span&gt;
&lt;span class="nl"&gt;BootMessage:&lt;/span&gt; &lt;span class="nf"&gt;db&lt;/span&gt; &lt;span class="err"&gt;"&lt;/span&gt;&lt;span class="no"&gt;Hello&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="no"&gt;OS&lt;/span&gt; &lt;span class="no"&gt;world&lt;/span&gt;&lt;span class="p"&gt;!&lt;/span&gt;&lt;span class="err"&gt;"&lt;/span&gt;
&lt;span class="nf"&gt;times&lt;/span&gt; &lt;span class="mi"&gt;510&lt;/span&gt;&lt;span class="p"&gt;-(&lt;/span&gt;&lt;span class="no"&gt;$-$$&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="no"&gt;db&lt;/span&gt; &lt;span class="mi"&gt;&lt;/span&gt; &lt;span class="c"&gt;;使用0填充剩下的空间&lt;/span&gt;
&lt;span class="nf"&gt;dw&lt;/span&gt; &lt;span class="mi"&gt;0xaa55&lt;/span&gt; &lt;span class="c"&gt;;结束标志&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;h2 id="编译"&gt;编译
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;nasm boot.asm -o boot.bin&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="写入软盘"&gt;写入软盘
&lt;/h2&gt;&lt;p&gt;然后这个时候可爱的作者让我们写到软盘里= =&lt;/p&gt;
&lt;p&gt;这个时候很多朋友都会&lt;/p&gt;
&lt;p&gt;&lt;code&gt;dd if=boot.bin of=/dev/sdx&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;比如一开始的我= =&lt;/p&gt;
&lt;p&gt;我写到了8G的U盘里&lt;/p&gt;
&lt;p&gt;其实我们可以用virtualbox来搞定&lt;/p&gt;
&lt;p&gt;建立一个虚拟机——我选的是ubuntu_32bit——我觉得挺麻烦的，所以就不换了，因为我成功了。&lt;/p&gt;
&lt;p&gt;在设置，存储中，点添加软盘控制器。&lt;/p&gt;
&lt;p&gt;然后我们使用dd命令建立一个虚拟软盘。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;dd if=boot.bin of=floppy.img count=2880&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;然后选择虚拟软盘。。选择floppy.img然后启动看。&lt;/p&gt;
&lt;p&gt;然后就可以看到可爱的&lt;code&gt;Hello,OS world!&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;本文参考： Linux 下制作虚拟软盘镜像 &lt;a class="link" href="http://blog.163.com/wascm@126/blog/static/9385027200851905148317/" target="_blank" rel="noopener"
&gt;http://blog.163.com/wascm@126/blog/static/9385027200851905148317/&lt;/a&gt;&lt;/p&gt;</description></item></channel></rss>